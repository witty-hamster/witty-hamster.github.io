import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as a,e,o as t}from"./app-rM1WJOZm.js";const l={};function n(h,i){return t(),a("div",null,i[0]||(i[0]=[e(`<h2 id="概述" tabindex="-1"><a class="header-anchor" href="#概述"><span>概述</span></a></h2><p><code>CompletableFuture</code> 是 Java 8 引入的一个强大的工具类，用于支持 <b style="color:red;font-size:17px;">异步编程</b> 和 <b style="color:red;font-size:17px;">非阻塞式操作</b> 。它实现了 <code>Future</code> 和 <code>CompletionStage</code> 接口，不仅可以获取异步任务的结果（像 <code>Future</code> 一样），还能以声明式的方式对多个异步任务进行组合、链式调用、异常处理等操作。</p><h2 id="一、核心特性" tabindex="-1"><a class="header-anchor" href="#一、核心特性"><span>一、核心特性</span></a></h2><ul><li><strong>异步执行</strong>：可以在后台线程中执行任务</li><li><strong>结果设置</strong>：可以手动完成一个 <code>CompletableFuture</code></li><li><strong>链式调用</strong>：通过 <code>thenApply</code>、<code>thenAccept</code>、<code>thenRun</code> 等方法构建任务流水线</li><li><strong>组合多个 Future</strong>：如 <code>allOf</code>、<code>anyOf</code></li><li><strong>异常处理</strong>：提供 <code>exceptionally</code>、<code>handle</code> 等方式处理异常</li><li><strong>非阻塞</strong>：避免了传统 <code>Future.get()</code> 的阻塞问题</li></ul><h2 id="二、常用静态工厂方法" tabindex="-1"><a class="header-anchor" href="#二、常用静态工厂方法"><span>二、常用静态工厂方法</span></a></h2><blockquote><p>用于创建 <code>CompletableFuture</code> 的方法，形式为： <code>public static &lt;?&gt; CompletableFuture&lt;?&gt; XXX() {}</code></p></blockquote><table><thead><tr><th>方法</th><th>说明</th></tr></thead><tbody><tr><td><code>public static CompletableFuture&lt;Void&gt; runAsync(Runnable runnable)</code></td><td>异步执行无返回值任务，默认使用 <code>ForkJoinPool.commonPool()</code> 线程池</td></tr><tr><td><code>public static CompletableFuture&lt;Void&gt; runAsync(Runnable runnable, Executor executor)</code></td><td>异步执行无返回值任务，使用指定线程池执行</td></tr><tr><td><code>public static &lt;U&gt; CompletableFuture&lt;U&gt; supplyAsync(Supplier&lt;U&gt; supplier)</code></td><td>异步执行有返回值任务，默认使用 <code>ForkJoinPool.commonPool()</code> 线程池</td></tr><tr><td><code>public static &lt;U&gt; CompletableFuture&lt;U&gt; supplyAsync(Supplier&lt;U&gt; supplier, Executor executor)</code></td><td>异步执行有返回值任务，使用指定线程池执行</td></tr><tr><td><code>public static &lt;U&gt; CompletableFuture&lt;U&gt; completedFuture(U value)</code></td><td>创建一个已经完成的 <code>CompletableFuture</code>（立即可用）</td></tr><tr><td><code>public static CompletableFuture&lt;Void&gt; allOf(CompletableFuture&lt;?&gt;... cfs)</code></td><td>当所有给定的 <code>CompletableFuture</code> 完成时完成</td></tr><tr><td><code>public static CompletableFuture&lt;Object&gt; anyOf(CompletableFuture&lt;?&gt;... cfs)</code></td><td>当任意一个 <code>CompletableFuture</code> 完成时完成</td></tr></tbody></table><h2 id="三、核心方法详解" tabindex="-1"><a class="header-anchor" href="#三、核心方法详解"><span>三、核心方法详解</span></a></h2><h3 id="_1-设置结果-手动完成" tabindex="-1"><a class="header-anchor" href="#_1-设置结果-手动完成"><span>1. 设置结果（手动完成）</span></a></h3><blockquote><p>常用于手动控制 future 的完成状态</p></blockquote><ul><li><p><code>public boolean complete(T value)</code></p><p>如果尚未完成，则以给定值完成该 future，并返回 true；否则返回 false</p></li><li><p><code>public boolean completeExceptionally(Throwable ex)</code></p><p>以异常方式完成该 future</p></li></ul><h3 id="_2-获取结果-阻塞式或非阻塞式" tabindex="-1"><a class="header-anchor" href="#_2-获取结果-阻塞式或非阻塞式"><span>2. 获取结果（阻塞式或非阻塞式）</span></a></h3><ul><li><code>public T get()</code>：阻塞式直到完成（继承至 <code>Future</code>）</li><li><code>public T get(long timeout, TimeUnit unit)</code>：带超时的阻塞式</li><li><code>public T join()</code>：类似 <code>get()</code>，但不抛出受检异常（推荐在链式调用中使用）</li><li><code>public T getNow(T valueIfAbsent)</code>：如果已完成则返回结果，否则返回指定默认值（不阻塞）</li></ul><h3 id="_3-转换与消费-函数式链式调用" tabindex="-1"><a class="header-anchor" href="#_3-转换与消费-函数式链式调用"><span>3. 转换与消费（函数式链式调用）</span></a></h3><blockquote><p>这些方法返回新的 <code>CompletableFuture</code>，构成流水线</p></blockquote><h4 id="_3-1-转换结果-有输入有输出" tabindex="-1"><a class="header-anchor" href="#_3-1-转换结果-有输入有输出"><span>3.1 转换结果（有输入有输出）</span></a></h4><ul><li><p><code>public &lt;U&gt; CompletableFuture&lt;U&gt; thenApply(Function&lt;? super T,? extends U&gt; fn)</code></p><p>当前阶段完成后，应用函数转换结果（同步执行在当前线程或完成线程）</p></li><li><p><code>public &lt;U&gt; CompletableFuture&lt;U&gt; thenApplyAsync(Function&lt;? super T,? extends U&gt; fn)</code></p><p>异步执行转换（使用默认线程池）</p></li><li><p><code>public &lt;U&gt; CompletableFuture&lt;U&gt; thenApplyAsync(Function&lt;? super T,? extends U&gt; fn, Executor executor)</code></p><p>异步执行转换（使用指定线程池）</p></li></ul><h4 id="_3-2-消费结果-有输入无输出" tabindex="-1"><a class="header-anchor" href="#_3-2-消费结果-有输入无输出"><span>3.2 消费结果（有输入无输出）</span></a></h4><ul><li><p><code>public CompletableFuture&lt;Void&gt; thenAccept(Consumer&lt;? super T&gt; action)</code></p><p>消费结果，不返回新值（返回 <code>CompletableFuture&lt;Void&gt;</code>）</p></li><li><p><code>public CompletableFuture&lt;Void&gt; thenAcceptAsync(...)</code></p><p>异步版本</p></li></ul><h4 id="_3-3-无输入无输出-仅执行动作" tabindex="-1"><a class="header-anchor" href="#_3-3-无输入无输出-仅执行动作"><span>3.3 无输入无输出（仅执行动作）</span></a></h4><ul><li><p><code>public CompletableFuture&lt;Void&gt; thenRun(Runnable action)</code></p><p>不关心前一步结果，只在前一步完成后执行</p></li><li><p><code>public CompletableFuture&lt;Void&gt; thenRunAsync(...)</code></p><p>异步版本</p></li></ul><h3 id="_4-异常处理" tabindex="-1"><a class="header-anchor" href="#_4-异常处理"><span>4. 异常处理</span></a></h3><ul><li><p><code>public CompletableFuture&lt;T&gt; exceptionally(Function&lt;Throwable, ? extends T&gt; fn)</code></p><p>仅在发生异常是调用，返回一个替代结果（类型必须与原 future 一致）</p></li></ul><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">CompletableFuture</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> cf </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> CompletableFuture</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">supplyAsync</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#C18401;--shiki-dark:#C678DD;">-&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    throw</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> RuntimeException</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;error&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}).</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">exceptionally</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(ex </span><span style="--shiki-light:#C18401;--shiki-dark:#C678DD;">-&gt;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;defualt&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p><code>public &lt;U&gt; CompletableFuture&lt;U&gt; handle(BiFunction&lt;? super T, Throwable, ? extends U&gt; fn)</code></p><p>无论成功或失败都会调用，可同时访问结果和异常</p></li></ul><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">CompletableFuture</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">supplyAsync</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#C18401;--shiki-dark:#C678DD;">-&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    throw</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;"> new</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> RuntimeException</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;error&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">);</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">}).</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">handle</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">((result, ex) </span><span style="--shiki-light:#C18401;--shiki-dark:#C678DD;">-&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">    if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (ex </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">!=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;error: &quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> ex</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getMessage</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    } </span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">else</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> result;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">})</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p><code>public CompletableFuture&lt;T&gt; whenComplete(BiConsumer&lt;? super T, ? super Throwable&gt; action)</code></p><p>类似 <code>handle</code>，但不改变结果（返回原类型），仅用于副作用（如日志）</p></li></ul><h3 id="_5-组合多个-completablefuture" tabindex="-1"><a class="header-anchor" href="#_5-组合多个-completablefuture"><span>5. 组合多个 <code>CompletableFuture</code></span></a></h3><h4 id="_5-1-顺序依赖" tabindex="-1"><a class="header-anchor" href="#_5-1-顺序依赖"><span>5.1 顺序依赖</span></a></h4><ul><li><p><code>public &lt;U&gt; CompletableFuture&lt;U&gt; thenCompose(Function&lt;? super T, ? extends CompletionStage&lt;U&gt;&gt; fn)</code></p><p>用于扁平化嵌套的 <code>CompletableFuture</code>（类似 <code>flatMap</code>）</p></li></ul><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">CompletableFuture</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> cf1 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ...;</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">CompletableFuture</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Integer</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> cf2 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> cf1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">thenCompose</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(s </span><span style="--shiki-light:#C18401;--shiki-dark:#C678DD;">-&gt;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"> queryDb</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(s));</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // queryDb 返回 CompletableFuture&lt;Integer&gt;</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5-2-并行组合-两个-future-同时进行" tabindex="-1"><a class="header-anchor" href="#_5-2-并行组合-两个-future-同时进行"><span>5.2 并行组合（两个 future 同时进行）</span></a></h4><ul><li><p><code>public &lt;U,V&gt; CompletableFuture&lt;V&gt; thenCombine(CompletionStage&lt;? extends U&gt; other,BiFunction&lt;? super T,? super U,? extends V&gt; fn)</code></p><p>当两个 future 都完成后，合并它们的结果</p></li></ul><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">CompletableFuture</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> cf1 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ...;</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">CompletableFuture</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Integer</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> cf2 </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> ...;</span></span>
<span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">CompletableFuture</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> result </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> cf1</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">thenCombine</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(cf2, (s, i) </span><span style="--shiki-light:#C18401;--shiki-dark:#C678DD;">-&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> s </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> i);</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="_5-3-多个-future-组合" tabindex="-1"><a class="header-anchor" href="#_5-3-多个-future-组合"><span>5.3 多个 future 组合</span></a></h4><ul><li><p><code>public static CompletableFuture&lt;Void&gt; allOf(CompletableFuture&lt;?&gt;... cfs)</code></p><p>所有 future 完成后才完成，<strong>不携带结果</strong>（返回 <code>CompletableFuture&lt;Void&gt;</code>）</p></li></ul><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">CompletableFuture</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">Void</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> all </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> CompletableFuture</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">allOf</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(cf1, cf2, cf3);</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">all</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">join</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;"> // 等待全部完成</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><ul><li><p><code>public static CompletableFuture&lt;Object&gt; anyOf(CompletableFuture&lt;?&gt;... cfs)</code></p><p>任意一个完成即完成，返回 <code>CompletableFuture&lt;Object&gt;</code>（需强转）</p></li></ul><h3 id="_6-其他实用方法" tabindex="-1"><a class="header-anchor" href="#_6-其他实用方法"><span>6. 其他实用方法</span></a></h3><ul><li><code>public boolean isDone()</code>：是否已完成（正常或异常）</li><li><code>public boolean isCompletedExceptionally()</code>：是否因异常完成</li><li><code>public void obtrudeValue(T value) / public void obtrudeException(Throwable ex)</code>：强制覆盖结果（<strong>不推荐生产使用</strong>）</li></ul><h2 id="四、示例代码" tabindex="-1"><a class="header-anchor" href="#四、示例代码"><span>四、示例代码</span></a></h2><div class="language-java line-numbers-mode" data-highlighter="shiki" data-ext="java" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code class="language-java"><span class="line"><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">CompletableFuture</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">&lt;</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;">String</span><span style="--shiki-light:#E45649;--shiki-dark:#ABB2BF;">&gt;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;"> future </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">=</span><span style="--shiki-light:#C18401;--shiki-dark:#E5C07B;"> CompletableFuture</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    .</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">supplyAsync</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(() </span><span style="--shiki-light:#C18401;--shiki-dark:#C678DD;">-&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">        System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;Task running in &quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> Thread</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">currentThread</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">().</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getName</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">());</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Hello&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    })</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    .</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">thenApply</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(s </span><span style="--shiki-light:#C18401;--shiki-dark:#C678DD;">-&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> s </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">+</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot; World&quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    .</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">thenApplyAsync</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(String</span><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">::</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">toUpperCase)</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    .</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">handle</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">((result, ex) </span><span style="--shiki-light:#C18401;--shiki-dark:#C678DD;">-&gt;</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        if</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> (ex </span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;">!=</span><span style="--shiki-light:#986801;--shiki-dark:#D19A66;"> null</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">) {</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">            return</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Error occurred &quot;</span><span style="--shiki-light:#383A42;--shiki-dark:#56B6C2;"> +</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;"> ex</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">getMessage</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">();</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">        }</span></span>
<span class="line"><span style="--shiki-light:#A626A4;--shiki-dark:#C678DD;">        return</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> result;</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">    });</span></span>
<span class="line"><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">System</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">out</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">println</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">(</span><span style="--shiki-light:#E45649;--shiki-dark:#E5C07B;">future</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">.</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">join</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">());</span><span style="--shiki-light:#A0A1A7;--shiki-light-font-style:italic;--shiki-dark:#7F848E;--shiki-dark-font-style:italic;">  // 输出 HELLO WORLD</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="五、使用建议" tabindex="-1"><a class="header-anchor" href="#五、使用建议"><span>五、使用建议</span></a></h2><ul><li><strong>避免阻塞</strong>：尽量使用 <code>join()</code> 而不是 <code>get()</code>（除非需要处理中断）。</li><li><strong>指定线程池</strong>：不要依赖默认的 <code>ForkJoinPool</code>，尤其在 I/O 密集型任务中。</li><li><strong>异常处理</strong>：始终考虑使用 <code>exceptionally</code> 或 <code>handle</code> 防止未处理异常导致静默失败。</li><li><strong>链式优于嵌套</strong>：使用 <code>thenCompose</code> 避免 <code>CompletableFuture&lt;CompletableFuture&lt;T&gt;&gt;</code>。</li><li><strong>资源管理</strong>：若使用自定义 <code>Executor</code>，注意生命周期管理（如关闭线程池）。</li></ul>`,44)]))}const r=s(l,[["render",n]]),d=JSON.parse('{"path":"/posts/%E6%94%B6%E9%9B%86%E7%AE%B1/CompletableFuture%20%E7%B1%BB%E8%AF%A6%E8%A7%A3.html","title":"Java8 - CompletableFuture 异步编程核心工具类详解","lang":"zh-CN","frontmatter":{"title":"Java8 - CompletableFuture 异步编程核心工具类详解","icon":"devicon:java-wordmark","date":"2025-12-04T00:00:00.000Z","category":["收集箱"],"tags":["异步&多线程","Java"],"star":false,"sticky":false,"description":"概述 CompletableFuture 是 Java 8 引入的一个强大的工具类，用于支持 异步编程 和 非阻塞式操作 。它实现了 Future 和 CompletionStage 接口，不仅可以获取异步任务的结果（像 Future 一样），还能以声明式的方式对多个异步任务进行组合、链式调用、异常处理等操作。 一、核心特性 异步执行：可以在后台线程中...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"Java8 - CompletableFuture 异步编程核心工具类详解\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2025-12-04T00:00:00.000Z\\",\\"dateModified\\":\\"2025-12-04T02:41:37.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Hamster\\",\\"url\\":\\"https://witty-hamster.github.io\\"}]}"],["meta",{"property":"og:url","content":"https://witty-hamster.github.io/posts/%E6%94%B6%E9%9B%86%E7%AE%B1/CompletableFuture%20%E7%B1%BB%E8%AF%A6%E8%A7%A3.html"}],["meta",{"property":"og:title","content":"Java8 - CompletableFuture 异步编程核心工具类详解"}],["meta",{"property":"og:description","content":"概述 CompletableFuture 是 Java 8 引入的一个强大的工具类，用于支持 异步编程 和 非阻塞式操作 。它实现了 Future 和 CompletionStage 接口，不仅可以获取异步任务的结果（像 Future 一样），还能以声明式的方式对多个异步任务进行组合、链式调用、异常处理等操作。 一、核心特性 异步执行：可以在后台线程中..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-12-04T02:41:37.000Z"}],["meta",{"property":"article:tag","content":"Java"}],["meta",{"property":"article:tag","content":"异步&多线程"}],["meta",{"property":"article:published_time","content":"2025-12-04T00:00:00.000Z"}],["meta",{"property":"article:modified_time","content":"2025-12-04T02:41:37.000Z"}]]},"git":{"createdTime":1764816097000,"updatedTime":1764816097000,"contributors":[{"name":"hamster","username":"hamster","email":"cuiguodong_2012@163.com","commits":1,"url":"https://github.com/hamster"}]},"readingTime":{"minutes":4.49,"words":1346},"filePathRelative":"posts/收集箱/CompletableFuture 类详解.md","excerpt":"<h2>概述</h2>\\n<p><code>CompletableFuture</code> 是 Java 8 引入的一个强大的工具类，用于支持 <b style=\\"color:red;font-size:17px\\">异步编程</b> 和 <b style=\\"color:red;font-size:17px\\">非阻塞式操作</b> 。它实现了 <code>Future</code> 和 <code>CompletionStage</code> 接口，不仅可以获取异步任务的结果（像 <code>Future</code> 一样），还能以声明式的方式对多个异步任务进行组合、链式调用、异常处理等操作。</p>","autoDesc":true}');export{r as comp,d as data};
